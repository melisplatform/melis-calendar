function responsiveCalendar(){var e=$(this),t=$("#id_meliscalendar_tool .row .col-md-4");$(window).width()<=991?t.insertAfter(e.parent().find("#id_meliscalendar_tool .row .col-md-8")):t.insertBefore(e.parent().find("#id_meliscalendar_tool .row .col-md-8"))}!function(e,t){function n(t){e.extend(!0,ue,t)}function a(n,a,c){function d(){a.theme?"ui":"fc",n.addClass("fc"),a.isRTL?n.addClass("fc-rtl"):n.addClass("fc-ltr"),a.theme&&n.addClass("ui-widget"),W=e("<div class='fc-content' style='position:relative'/>").prependTo(n),O=new r(A,a),($=O.render())&&n.prepend($),p(a.defaultView),a.handleWindowResize&&e(window).resize(T),h()||u()}function u(){setTimeout(function(){!L.start&&h()&&y()},0)}function v(){return n.is(":visible")}function h(){return e("body").is(":visible")}function p(e){L&&e==L.name||m(e)}function m(t){X++,L&&(z("viewDestroy",L,L,L.element),R(),L.triggerEventDestroy(),F(),L.element.remove(),O.deactivateButton(L.name)),O.activateButton(t),L=new he[t](e("<div class='fc-view fc-view-"+t+"' style='position:relative'/>").appendTo(W),A),y(),N(),X--}function y(e){(!L.start||e||L.start>J||J>=L.end)&&v()&&D(e)}function D(e){X++,L.start&&(z("viewDestroy",L,L,L.element),R(),x()),F(),L.render(J,e||0),M(),N(),(L.afterRender||function(){})(),O.updateTitle(L.title),function(){var e=new Date;e>=L.start&&L.end>e?O.disableButton("today"):O.enableButton("today")}(),z("viewRender",L,L,L.element),L.trigger("viewDisplay",B),X--,!a.lazyFetching||I(L.visStart,L.visEnd)?H():S()}function _(){v()&&(R(),x(),C(),M(),S())}function C(){Y=a.contentHeight?a.contentHeight:a.height?a.height-($?$.height():0)-k(W):Math.round(W.width()/Math.max(a.aspectRatio,.5))}function M(){Y===t&&C(),X++,L.setHeight(Y),L.setWidth(W.width()),X--,j=n.outerWidth()}function T(){if(!X)if(L.start){var e=++V;setTimeout(function(){e==V&&!X&&v()&&j!=(j=n.outerWidth())&&(X++,_(),L.trigger("windowResize",B),X--)},200)}else u()}function E(e){x(),S(e)}function S(e){v()&&(L.setEventData(K),L.renderEvents(K,e),L.trigger("eventAfterAllRender"))}function x(){L.triggerEventDestroy(),L.clearEvents(),L.clearEventData()}function H(){q(L.visStart,L.visEnd)}function R(){L&&L.unselect()}function F(){W.css({width:"100%",height:W.height(),overflow:"hidden"})}function N(){W.css({width:"",height:"",overflow:""})}function z(e,n){return a[e]?a[e].apply(n||B,Array.prototype.slice.call(arguments,2)):t}var A=this;A.options=a,A.render=function(e){W?v()&&(C(),D(e)):d()},A.destroy=function(){L&&(z("viewDestroy",L,L,L.element),L.triggerEventDestroy()),e(window).unbind("resize",T),O.destroy(),W.remove(),n.removeClass("fc fc-rtl ui-widget")},A.refetchEvents=function(){x(),H()},A.reportEvents=function(e){K=e,S()},A.reportEventChange=function(e){E(e)},A.rerenderEvents=E,A.changeView=p,A.select=function(e,n,a){L.select(e,n,a===t||a)},A.unselect=R,A.prev=function(){y(-1)},A.next=function(){y(1)},A.prevYear=function(){i(J,-1),y()},A.nextYear=function(){i(J,1),y()},A.today=function(){J=new Date,y()},A.gotoDate=function(e,t,n){e instanceof Date?J=f(e):g(J,e,t,n),y()},A.incrementDate=function(e,n,a){e!==t&&i(J,e),n!==t&&l(J,n),a!==t&&s(J,a),y()},A.formatDate=function(e,t){return w(e,t,a)},A.formatDates=function(e,t,n){return b(e,t,n,a)},A.getDate=function(){return f(J)},A.getView=function(){return L},A.option=function(e,n){return n===t?a[e]:(("height"==e||"contentHeight"==e||"aspectRatio"==e)&&(a[e]=n,_()),t)},A.trigger=z,o.call(A,a,c);var O,$,W,L,j,Y,P,I=A.isFetchNeeded,q=A.fetchEvents,B=n[0],V=0,X=0,J=new Date,K=[];g(J,a.year,a.month,a.date),a.droppable&&e(document).bind("dragstart",function(t,n){var r=t.target,o=e(r);if(!o.parents(".fc").length){var i=a.dropAccept;(e.isFunction(i)?i.call(r,o):o.is(i))&&(P=r,L.dragStart(P,t,n))}}).bind("dragstop",function(e,t){P&&(L.dragStop(P,e,t),P=null)})}function r(n,a){function r(t){var r=e("<td class='fc-header-"+t+"'/>"),o=a.header[t];return o&&e.each(o.split(" "),function(t){var o;t>0&&r.append("<span class='fc-header-space'/>"),e.each(this.split(","),function(t,l){var s;if("title"==l)r.append("<span class='fc-header-title'><h2>&nbsp;</h2></span>"),o&&o.addClass(i+"-corner-right"),o=null;else if(n[l]?s=n[l]:he[l]&&(s=function(){u.removeClass(i+"-state-hover"),n.changeView(l)}),s){var c=a.theme?O(a.buttonIcons,l):null,d=O(a.buttonText,l),u=e("<span class='fc-button fc-button-"+l+" "+i+"-state-default'>"+(c?"<span class='fc-icon-wrap'><span class='ui-icon ui-icon-"+c+"'/></span>":d)+"</span>").click(function(){u.hasClass(i+"-state-disabled")||s()}).mousedown(function(){u.not("."+i+"-state-active").not("."+i+"-state-disabled").addClass(i+"-state-down")}).mouseup(function(){u.removeClass(i+"-state-down")}).hover(function(){u.not("."+i+"-state-active").not("."+i+"-state-disabled").addClass(i+"-state-hover")},function(){u.removeClass(i+"-state-hover").removeClass(i+"-state-down")}).appendTo(r);W(u),o||u.addClass(i+"-corner-left"),o=u}}),o&&o.addClass(i+"-corner-right")}),r}var o=this;o.render=function(){return i=a.theme?"ui":"fc",a.header?l=e("<table class='fc-header' style='width:100%'/>").append(e("<tr/>").append(r("left")).append(r("center")).append(r("right"))):t},o.destroy=function(){l.remove()},o.updateTitle=function(e){l.find("h2").html(e)},o.activateButton=function(e){l.find("span.fc-button-"+e).addClass(i+"-state-active")},o.deactivateButton=function(e){l.find("span.fc-button-"+e).removeClass(i+"-state-active")},o.disableButton=function(e){l.find("span.fc-button-"+e).addClass(i+"-state-disabled")},o.enableButton=function(e){l.find("span.fc-button-"+e).removeClass(i+"-state-disabled")};var i,l=e([])}function o(n,a){function r(t,a){o(t,function(r){if(a==_){if(r){n.eventDataTransform&&(r=e.map(r,n.eventDataTransform)),t.eventDataTransform&&(r=e.map(r,t.eventDataTransform));for(var o=0;r.length>o;o++)r[o].source=t,c(r[o]);T=T.concat(r)}--C||w(T)}})}function o(a,r){var i,c,d=ve.sourceFetchers;for(i=0;d.length>i;i++){if(!0===(c=d[i](a,h,g,r)))return;if("object"==typeof c)return o(c,r),t}var u=a.events;if(u)e.isFunction(u)?(l(),u(f(h),f(g),function(e){r(e),s()})):e.isArray(u)?r(u):r();else if(a.url){var v,p=a.success,m=a.error,y=a.complete;v=e.isFunction(a.data)?a.data():a.data;var w=e.extend({},v||{}),b=P(a.startParam,n.startParam),D=P(a.endParam,n.endParam);b&&(w[b]=Math.round(+h/1e3)),D&&(w[D]=Math.round(+g/1e3)),l(),e.ajax(e.extend({},ge,a,{data:w,success:function(t){t=t||[];var n=Y(p,this,arguments);e.isArray(n)&&(t=n),r(t)},error:function(){Y(m,this,arguments),r()},complete:function(){Y(y,this,arguments),s()}}))}else r()}function i(n){return e.isFunction(n)||e.isArray(n)?n={events:n}:"string"==typeof n&&(n={url:n}),"object"==typeof n?(function(e){e.className?"string"==typeof e.className&&(e.className=e.className.split(/\s+/)):e.className=[];for(var t=ve.sourceNormalizers,n=0;t.length>n;n++)t[n](e)}(n),D.push(n),n):t}function l(){M++||m("loading",null,!0,y())}function s(){--M||m("loading",null,!1,y())}function c(e){var a=e.source||{},r=P(a.ignoreTimezone,n.ignoreTimezone);e._id=e._id||(e.id===t?"_fc"+pe++:e.id+""),e.date&&(e.start||(e.start=e.date),delete e.date),e._start=f(e.start=p(e.start,r)),e.end=p(e.end,r),e.end&&e.end<=e.start&&(e.end=null),e._end=e.end?f(e.end):null,e.allDay===t&&(e.allDay=P(a.allDayDefault,n.allDayDefault)),e.className?"string"==typeof e.className&&(e.className=e.className.split(/\s+/)):e.className=[]}function d(e,t){return e&&t&&u(e)==u(t)}function u(e){return("object"==typeof e?e.events||e.url:"")||e}var v=this;v.isFetchNeeded=function(e,t){return!h||h>e||t>g},v.fetchEvents=function(e,t){h=e,g=t,T=[];var n=++_,a=D.length;C=a;for(var o=0;a>o;o++)r(D[o],n)},v.addEventSource=function(e){(e=i(e))&&(C++,r(e,_))},v.removeEventSource=function(t){D=e.grep(D,function(e){return!d(e,t)}),T=e.grep(T,function(e){return!d(e.source,t)}),w(T)},v.updateEvent=function(e){var t,n,a=T.length,r=y().defaultEventEnd,o=e.start-e._start,i=e.end?e.end-(e._end||r(e)):0;for(t=0;a>t;t++)(n=T[t])._id==e._id&&n!=e&&(n.start=new Date(+n.start+o),n.end=e.end?n.end?new Date(+n.end+i):new Date(+r(n)+i):null,n.title=e.title,n.url=e.url,n.allDay=e.allDay,n.className=e.className,n.editable=e.editable,n.color=e.color,n.backgroundColor=e.backgroundColor,n.borderColor=e.borderColor,n.textColor=e.textColor,c(n));c(e),w(T)},v.renderEvent=function(e,t){c(e),e.source||(t&&(b.events.push(e),e.source=b),T.push(e)),w(T)},v.removeEvents=function(t){if(t){if(!e.isFunction(t)){var n=t+"";t=function(e){return e._id==n}}T=e.grep(T,t,!0);for(var a=0;D.length>a;a++)e.isArray(D[a].events)&&(D[a].events=e.grep(D[a].events,t,!0))}else for(T=[],a=0;D.length>a;a++)e.isArray(D[a].events)&&(D[a].events=[]);w(T)},v.clientEvents=function(t){return e.isFunction(t)?e.grep(T,t):t?(t+="",e.grep(T,function(e){return e._id==t})):T},v.normalizeEvent=c;for(var h,g,m=v.trigger,y=v.getView,w=v.reportEvents,b={events:[]},D=[b],_=0,C=0,M=0,T=[],E=0;a.length>E;E++)i(a[E])}function i(e,t,n){return e.setFullYear(e.getFullYear()+t),n||u(e),e}function l(e,t,n){if(+e){var a=e.getMonth()+t,r=f(e);for(r.setDate(1),r.setMonth(a),e.setMonth(a),n||u(e);e.getMonth()!=r.getMonth();)e.setDate(e.getDate()+(r>e?1:-1))}return e}function s(e,t,n){if(+e){var a=e.getDate()+t,r=f(e);r.setHours(9),r.setDate(a),e.setDate(a),n||u(e),c(e,r)}return e}function c(e,t){if(+e)for(;e.getDate()!=t.getDate();)e.setTime(+e+(t>e?1:-1)*we)}function d(e,t){return e.setMinutes(e.getMinutes()+t),e}function u(e){return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e}function f(e,t){return t?u(new Date(+e)):new Date(+e)}function v(){var e,t=0;do{e=new Date(1970,t++,1)}while(e.getHours());return e}function h(e,t){return Math.round((f(e,!0)-f(t,!0))/ye)}function g(e,n,a,r){n!==t&&n!=e.getFullYear()&&(e.setDate(1),e.setMonth(0),e.setFullYear(n)),a!==t&&a!=e.getMonth()&&(e.setDate(1),e.setMonth(a)),r!==t&&e.setDate(r)}function p(e,n){return"object"==typeof e?e:"number"==typeof e?new Date(1e3*e):"string"==typeof e?e.match(/^\d+(\.\d+)?$/)?new Date(1e3*parseFloat(e)):(n===t&&(n=!0),m(e,n)||(e?new Date(e):null)):null}function m(e,t){var n=e.match(/^([0-9]{4})(-([0-9]{2})(-([0-9]{2})([T ]([0-9]{2}):([0-9]{2})(:([0-9]{2})(\.([0-9]+))?)?(Z|(([-+])([0-9]{2})(:?([0-9]{2}))?))?)?)?)?$/);if(!n)return null;var a=new Date(n[1],0,1);if(t||!n[13]){var r=new Date(n[1],0,1,9,0);n[3]&&(a.setMonth(n[3]-1),r.setMonth(n[3]-1)),n[5]&&(a.setDate(n[5]),r.setDate(n[5])),c(a,r),n[7]&&a.setHours(n[7]),n[8]&&a.setMinutes(n[8]),n[10]&&a.setSeconds(n[10]),n[12]&&a.setMilliseconds(1e3*Number("0."+n[12])),c(a,r)}else if(a.setUTCFullYear(n[1],n[3]?n[3]-1:0,n[5]||1),a.setUTCHours(n[7]||0,n[8]||0,n[10]||0,n[12]?1e3*Number("0."+n[12]):0),n[14]){var o=60*Number(n[16])+(n[18]?Number(n[18]):0);o*="-"==n[15]?1:-1,a=new Date(+a+6e4*o)}return a}function y(e){if("number"==typeof e)return 60*e;if("object"==typeof e)return 60*e.getHours()+e.getMinutes();var t=e.match(/(\d+)(?::(\d+))?\s*(\w+)?/);if(t){var n=parseInt(t[1],10);return t[3]&&(n%=12,"p"==t[3].toLowerCase().charAt(0)&&(n+=12)),60*n+(t[2]?parseInt(t[2],10):0)}}function w(e,t,n){return b(e,null,t,n)}function b(e,t,n,a){a=a||ue;var r,o,i,l,s=e,c=t,d=n.length,u="";for(r=0;d>r;r++)if("'"==(o=n.charAt(r))){for(i=r+1;d>i;i++)if("'"==n.charAt(i)){s&&(u+=i==r+1?"'":n.substring(r+1,i),r=i);break}}else if("("==o){for(i=r+1;d>i;i++)if(")"==n.charAt(i)){var f=w(s,n.substring(r+1,i),a);parseInt(f.replace(/\D/,""),10)&&(u+=f),r=i;break}}else if("["==o){for(i=r+1;d>i;i++)if("]"==n.charAt(i)){var v=n.substring(r+1,i);(f=w(s,v,a))!=w(c,v,a)&&(u+=f),r=i;break}}else if("{"==o)s=t,c=e;else if("}"==o)s=e,c=t;else{for(i=d;i>r;i--)if(l=De[n.substring(r,i)]){s&&(u+=l(s,a)),r=i-1;break}i==r&&s&&(u+=o)}return u}function D(e){return e.end?function(e,t){return e=f(e),t||e.getHours()||e.getMinutes()?s(e,1):u(e)}(e.end,e.allDay):s(f(e.start),1)}function _(n,a,r){n.unbind("mouseover").mouseover(function(n){for(var o,i,l,s=n.target;s!=this;)o=s,s=s.parentNode;(i=o._fci)!==t&&(o._fci=t,l=a[i],r(l.event,l.element,l),e(n.target).trigger(n)),n.stopPropagation()})}function C(t,n,a){for(var r,o=0;t.length>o;o++)(r=e(t[o])).width(Math.max(0,n-T(r,a)))}function M(t,n,a){for(var r,o=0;t.length>o;o++)(r=e(t[o])).height(Math.max(0,n-k(r,a)))}function T(e,t){return E(e)+x(e)+(t?S(e):0)}function E(t){return(parseFloat(e.css(t[0],"paddingLeft",!0))||0)+(parseFloat(e.css(t[0],"paddingRight",!0))||0)}function S(t){return(parseFloat(e.css(t[0],"marginLeft",!0))||0)+(parseFloat(e.css(t[0],"marginRight",!0))||0)}function x(t){return(parseFloat(e.css(t[0],"borderLeftWidth",!0))||0)+(parseFloat(e.css(t[0],"borderRightWidth",!0))||0)}function k(e,t){return H(e)+F(e)+(t?R(e):0)}function H(t){return(parseFloat(e.css(t[0],"paddingTop",!0))||0)+(parseFloat(e.css(t[0],"paddingBottom",!0))||0)}function R(t){return(parseFloat(e.css(t[0],"marginTop",!0))||0)+(parseFloat(e.css(t[0],"marginBottom",!0))||0)}function F(t){return(parseFloat(e.css(t[0],"borderTopWidth",!0))||0)+(parseFloat(e.css(t[0],"borderBottomWidth",!0))||0)}function N(e,t){return e-t}function z(e){return Math.max.apply(Math,e)}function A(e){return(10>e?"0":"")+e}function O(e,n){if(e[n]!==t)return e[n];for(var a,r=n.split(/(?=[A-Z])/),o=r.length-1;o>=0;o--)if((a=e[r[o].toLowerCase()])!==t)return a;return e[""]}function $(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;").replace(/\n/g,"<br />")}function W(e){e.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return!1})}function L(e){e.children().removeClass("fc-first fc-last").filter(":first-child").addClass("fc-first").end().filter(":last-child").addClass("fc-last")}function j(e,t){var n=e.source||{},a=e.color,r=n.color,o=t("eventColor"),i=e.backgroundColor||a||n.backgroundColor||r||t("eventBackgroundColor")||o,l=e.borderColor||a||n.borderColor||r||t("eventBorderColor")||o,s=e.textColor||n.textColor||t("eventTextColor"),c=[];return i&&c.push("background-color:"+i),l&&c.push("border-color:"+l),s&&c.push("color:"+s),c.join(";")}function Y(t,n,a){if(e.isFunction(t)&&(t=[t]),t){var r,o;for(r=0;t.length>r;r++)o=t[r].apply(n,a)||o;return o}}function P(){for(var e=0;arguments.length>e;e++)if(arguments[e]!==t)return arguments[e]}function I(t,n,a){function r(){E=e("<div class='fc-event-container' style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(t)}function o(){var n="<table class='fc-border-separate' style='width:100%' cellspacing='0'>"+function(){var e,t,n=Y+"-widget-header",a="";for(a+="<thead><tr>",I&&(a+="<th class='fc-week-number "+n+"'>"+$(B)+"</th>"),e=0;F>e;e++)t=G(0,e),a+="<th class='fc-day-header fc-"+me[t.getDay()]+" "+n+"'>"+$(ne(t,P))+"</th>";return a+="</tr></thead>"}()+function(){var e,t,n,a=Y+"-widget-content",r="";for(r+="<tbody>",e=0;R>e;e++){for(r+="<tr class='fc-week'>",I&&(n=G(e,0),r+="<td class='fc-week-number "+a+"'><div>"+$(ne(n,V))+"</div></td>"),t=0;F>t;t++)n=G(e,t),r+=i(n);r+="</tr>"}return r+="</tbody>"}()+"</table>";g&&g.remove(),g=e(n).appendTo(t),p=g.find("thead"),y=p.find(".fc-day-header"),w=g.find("tbody"),b=w.find("tr"),D=w.find(".fc-day"),_=b.find("td:first-child"),M=b.eq(0).find(".fc-day > div"),T=b.eq(0).find(".fc-day-content > div"),L(p.add(p.find("tr"))),L(b),b.eq(0).addClass("fc-first"),b.filter(":last").addClass("fc-last"),D.each(function(t,n){var a=G(Math.floor(t/F),t%F);J("dayRender",h,a,e(n))}),l(D)}function i(e){var t=Y+"-widget-content",n=h.start.getMonth(),a=u(new Date),r="",o=["fc-day","fc-"+me[e.getDay()],t];return e.getMonth()!=n&&o.push("fc-other-month"),+e==+a?o.push("fc-today",Y+"-state-highlight"):a>e?o.push("fc-past"):o.push("fc-future"),r+="<td class='"+o.join(" ")+"' data-date='"+ne(e,"yyyy-MM-dd")+"'><div>",N&&(r+="<div class='fc-day-number'>"+e.getDate()+"</div>"),r+"<div class='fc-day-content'><div style='position:relative'>&nbsp;</div></div></div></td>"}function l(e){e.click(c).mousedown(Z)}function c(t){if(!X("selectable")){var n=m(e(this).data("date"));J("dayClick",this,n,!0,t)}}function d(e,t,n){n&&z.build();for(var a=te(e,t),r=0;a.length>r;r++){var o=a[r];l(v(o.row,o.leftCol,o.row,o.rightCol))}}function v(e,n,a,r){var o=z.rect(e,n,a,r,t);return K(o,t)}var h=this;h.renderBasic=function(e,t,n){R=e,F=t,N=n,Y=X("theme")?"ui":"fc",P=X("columnFormat"),I=X("weekNumbers"),B=X("weekNumberTitle"),V="iso"!=X("weekNumberCalculation")?"w":"W",w||r(),o()},h.setHeight=function(t){var n,a,r,o=t-p.height();"variable"==X("weekMode")?n=a=Math.floor(o/(1==R?2:6)):(n=Math.floor(o/R),a=o-n*(R-1)),_.each(function(t,o){R>t&&(r=e(o)).find("> div").css("min-height",(t==R-1?a:n)-k(r))})},h.setWidth=function(e){S=e,O.clear(),j.clear(),H=0,I&&(H=p.find("th.fc-week-number").outerWidth()),x=Math.floor((S-H)/F),C(y.slice(0,-1),x)},h.renderDayOverlay=d,h.defaultSelectionEnd=function(e){return f(e)},h.renderSelection=function(e,t){d(e,s(f(t),1),!0)},h.clearSelection=function(){U()},h.reportDayClick=function(e,t,n){var a=Q(e),r=D[a.row*F+a.col];J("dayClick",r,e,t,n)},h.dragStart=function(e,t){A.start(function(e){U(),e&&v(e.row,e.col,e.row,e.col)},t)},h.dragStop=function(e,t,n){var a=A.stop();if(U(),a){var r=G(a);J("drop",e,r,!0,t,n)}},h.defaultEventEnd=function(e){return f(e.start)},h.getHoverListener=function(){return A},h.colLeft=function(e){return O.left(e)},h.colRight=function(e){return O.right(e)},h.colContentLeft=function(e){return j.left(e)},h.colContentRight=function(e){return j.right(e)},h.getIsCellAllDay=function(){return!0},h.allDayRow=function(e){return b.eq(e)},h.getRowCnt=function(){return R},h.getColCnt=function(){return F},h.getColWidth=function(){return x},h.getDaySegmentContainer=function(){return E},ee.call(h,t,n,a),ie.call(h),oe.call(h),q.call(h);var g,p,y,w,b,D,_,M,T,E,S,x,H,R,F,N,z,A,O,j,Y,P,I,B,V,X=h.opt,J=h.trigger,K=h.renderOverlay,U=h.clearOverlays,Z=h.daySelectionMousedown,G=h.cellToDate,Q=h.dateToCell,te=h.rangeToSegments,ne=n.formatDate;W(t.addClass("fc-grid")),z=new le(function(t,n){var a,r,o;y.each(function(t,i){a=e(i),r=a.offset().left,t&&(o[1]=r),o=[r],n[t]=o}),o[1]=r+a.outerWidth(),b.each(function(n,i){R>n&&(a=e(i),r=a.offset().top,n&&(o[1]=r),o=[r],t[n]=o)}),o[1]=r+a.outerHeight()}),A=new se(z),O=new de(function(e){return M.eq(e)}),j=new de(function(e){return T.eq(e)})}function q(){var e=this;e.renderEvents=function(t,n){e.renderDayEvents(t,n)},e.clearEvents=function(){e.getDaySegmentContainer().empty()},te.call(e)}function B(n,a,r){function o(){var t,a,r,o,s,u=be+"-widget-header",h=be+"-widget-content",g=0==xe("slotMinutes")%15;for(i(),I=e("<div style='position:absolute;z-index:2;left:0;width:100%'/>").appendTo(n),xe("allDaySlot")?(q=e("<div class='fc-event-container' style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(I),t="<table style='width:100%' class='fc-agenda-allday' cellspacing='0'><tr><th class='"+u+" fc-agenda-axis'>"+xe("allDayText")+"</th><td><div class='fc-day-content'><div style='position:relative'/></div></td><th class='"+u+" fc-agenda-gutter'>&nbsp;</th></tr></table>",B=e(t).appendTo(I),l((X=B.find("tr")).find("td")),I.append("<div class='fc-agenda-divider "+u+"'><div class='fc-agenda-divider-inner'/></div>")):q=e([]),J=e("<div style='position:absolute;width:100%;overflow-x:hidden;overflow-y:auto'/>").appendTo(I),K=e("<div style='position:relative;width:100%;overflow:hidden'/>").appendTo(J),U=e("<div class='fc-event-container' style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(K),t="<table class='fc-agenda-slots' style='width:100%' cellspacing='0'><tbody>",o=d(f(a=v()),Ce),d(a,_e),he=0,r=0;o>a;r++)t+="<tr class='fc-slot"+r+" "+((s=a.getMinutes())?"fc-minor":"")+"'><th class='fc-agenda-axis "+u+"'>"+(g&&s?"&nbsp;":Le(a,xe("axisFormat")))+"</th><td class='"+h+"'><div style='position:relative'>&nbsp;</div></td></tr>",d(a,xe("slotMinutes")),he++;c((Z=e(t+="</tbody></table>").appendTo(K)).find("td"))}function i(){var t="<table style='width:100%' class='fc-agenda-days fc-border-separate' cellspacing='0'>"+function(){var e,t,n,a=be+"-widget-header",r="";for(r+="<thead><tr>",Te?(e=Oe(0,0),t=Le(e,Se),De?t+=Ee:t=Ee+t,r+="<th class='fc-agenda-axis fc-week-number "+a+"'>"+$(t)+"</th>"):r+="<th class='fc-agenda-axis "+a+"'>&nbsp;</th>",n=0;ve>n;n++)e=Oe(0,n),r+="<th class='fc-"+me[e.getDay()]+" fc-col"+n+" "+a+"'>"+$(Le(e,Me))+"</th>";return r+="<th class='fc-agenda-gutter "+a+"'>&nbsp;</th></tr></thead>"}()+function(){var e,t,n,a,r,o=be+"-widget-header",i=be+"-widget-content",l=u(new Date),s="";for(s+="<tbody><tr><th class='fc-agenda-axis "+o+"'>&nbsp;</th>",n="",t=0;ve>t;t++)e=Oe(0,t),r=["fc-col"+t,"fc-"+me[e.getDay()],i],+e==+l?r.push(be+"-state-highlight","fc-today"):l>e?r.push("fc-past"):r.push("fc-future"),a="<td class='"+r.join(" ")+"'><div><div class='fc-day-content'><div style='position:relative'>&nbsp;</div></div></div></td>",n+=a;return s+=n,s+="<td class='fc-agenda-gutter "+i+"'>&nbsp;</td></tr></tbody>"}()+"</table>";H&&H.remove(),H=e(t).appendTo(n),R=H.find("thead"),F=R.find("th").slice(1,-1),z=H.find("tbody"),A=z.find("td").slice(0,-1),O=A.find("> div"),j=A.find(".fc-day-content > div"),Y=A.eq(0),P=O.eq(0),L(R.add(R.find("tr"))),L(z.add(z.find("tr")))}function l(e){e.click(h).mousedown(ze)}function c(e){e.click(h).mousedown(E)}function h(e){if(!xe("selectable")){var t=Math.min(ve-1,Math.floor((e.pageX-H.offset().left-te)/ne)),n=Oe(0,t),a=this.parentNode.className.match(/fc-slot(\d+)/);if(a){var r=parseInt(a[1])*xe("slotMinutes"),o=Math.floor(r/60);n.setHours(o),n.setMinutes(r%60+_e),ke("dayClick",A[t],n,!1,e)}else ke("dayClick",A[t],n,!0,e)}}function g(e,t,n){n&&ge.build();for(var a=We(e,t),r=0;a.length>r;r++){var o=a[r];l(p(o.row,o.leftCol,o.row,o.rightCol))}}function p(e,t,n,a){var r=ge.rect(e,t,n,a,I);return He(r,I)}function m(e,t){for(var n=0;ve>n;n++){var a=Oe(0,n),r=s(f(a),1),o=new Date(Math.max(a,e)),i=new Date(Math.min(r,t));if(i>o){var l=ge.rect(0,n,0,n,K),d=D(a,o),u=D(a,i);l.top=d,l.height=u-d,c(He(l,K))}}}function w(e){return xe("allDaySlot")&&!e.row}function b(e){var t=Oe(0,e.col),n=e.row;return xe("allDaySlot")&&n--,n>=0&&d(t,_e+n*ce),t}function D(e,n){if(e=f(e,!0),d(f(e),_e)>n)return 0;if(n>=d(f(e),Ce))return Z.height();var a=xe("slotMinutes"),r=60*n.getHours()+n.getMinutes()-_e,o=Math.floor(r/a),i=je[o];return i===t&&(i=je[o]=Z.find("tr").eq(o).find("td div")[0].offsetTop),Math.max(0,Math.round(i-1+re*(r%a/a)))}function _(t,n){var a=xe("selectHelper");if(ge.build(),a){var r=$e(t).col;if(r>=0&&ve>r){var o=ge.rect(0,r,0,r,K),i=D(t,t),l=D(t,n);if(l>i){if(o.top=i,o.height=l-i,o.left+=2,o.width-=5,e.isFunction(a)){var s=a(t,n);s&&(o.position="absolute",G=e(s).css(o).appendTo(K))}else o.isStart=!0,o.isEnd=!0,(G=e(Ae({title:"",start:t,end:n,className:["fc-select-helper"],editable:!1},o))).css("opacity",xe("dragOpacity"));G&&(c(G),K.append(G),C(G,o.width,!0),M(G,o.height,!0))}}}else m(t,n)}function T(){Re(),G&&(G.remove(),G=null)}function E(t){var n;1==t.which&&xe("selectable")&&(Ne(t),pe.start(function(e,t){if(T(),e&&e.col==t.col&&!w(e)){var a=b(t),r=b(e);_((n=[a,d(f(a),ce),r,d(f(r),ce)].sort(N))[0],n[3])}else n=null},t),e(document).one("mouseup",function(e){pe.stop(),n&&(+n[0]==+n[1]&&S(n[0],!1,e),Fe(n[0],n[3],!1,e))}))}function S(e,t,n){ke("dayClick",A[$e(e).col],e,t,n)}var x=this;x.renderAgenda=function(e){ve=e,be=xe("theme")?"ui":"fc",De=xe("isRTL"),_e=y(xe("minTime")),Ce=y(xe("maxTime")),Me=xe("columnFormat"),Te=xe("weekNumbers"),Ee=xe("weekNumberTitle"),Se="iso"!=xe("weekNumberCalculation")?"w":"W",ce=xe("snapMinutes")||xe("slotMinutes"),H?i():o()},x.setWidth=function(t){t,ye.clear(),we.clear();var n=R.find("th:first");B&&(n=n.add(B.find("th:first"))),n=n.add(Z.find("th:first")),te=0,C(n.width("").each(function(t,n){te=Math.max(te,e(n).outerWidth())}),te);var a=H.find(".fc-agenda-gutter");B&&(a=a.add(B.find("th.fc-agenda-gutter")));var r=J[0].clientWidth;(ae=J.width()-r)?(C(a,ae),a.show().prev().removeClass("fc-last")):a.hide().prev().addClass("fc-last"),ne=Math.floor((r-te)/ve),C(F.slice(0,-1),ne)},x.setHeight=function(e){e===t&&(e=Q),Q=e,je={};var n=z.position().top,a=J.position().top,r=Math.min(e-n,Z.height()+a+1);P.height(r-k(Y)),I.css("top",n),J.height(r-a-1),re=Z.find("tr:first").height()+1,ue=xe("slotMinutes")/ce,fe=re/ue},x.afterRender=function(){!function(){function e(){J.scrollTop(a)}var t=v(),n=f(t);n.setHours(xe("firstHour"));var a=D(t,n)+1;e(),setTimeout(e,0)}()},x.defaultEventEnd=function(e){var t=f(e.start);return e.allDay?t:d(t,xe("defaultEventMinutes"))},x.timePosition=D,x.getIsCellAllDay=w,x.allDayRow=function(){return X},x.getCoordinateGrid=function(){return ge},x.getHoverListener=function(){return pe},x.colLeft=function(e){return ye.left(e)},x.colRight=function(e){return ye.right(e)},x.colContentLeft=function(e){return we.left(e)},x.colContentRight=function(e){return we.right(e)},x.getDaySegmentContainer=function(){return q},x.getSlotSegmentContainer=function(){return U},x.getMinMinute=function(){return _e},x.getMaxMinute=function(){return Ce},x.getSlotContainer=function(){return K},x.getRowCnt=function(){return 1},x.getColCnt=function(){return ve},x.getColWidth=function(){return ne},x.getSnapHeight=function(){return fe},x.getSnapMinutes=function(){return ce},x.defaultSelectionEnd=function(e,t){return t?f(e):d(f(e),xe("slotMinutes"))},x.renderDayOverlay=g,x.renderSelection=function(e,t,n){n?xe("allDaySlot")&&g(e,s(f(t),1),!0):_(e,t)},x.clearSelection=T,x.reportDayClick=S,x.dragStart=function(e,t){pe.start(function(e){if(Re(),e)if(w(e))p(e.row,e.col,e.row,e.col);else{var t=b(e);m(t,d(f(t),xe("defaultEventMinutes")))}},t)},x.dragStop=function(e,t,n){var a=pe.stop();Re(),a&&ke("drop",e,b(a),w(a),t,n)},ee.call(x,n,a,r),ie.call(x),oe.call(x),V.call(x);var H,R,F,z,A,O,j,Y,P,I,q,B,X,J,K,U,Z,G,Q,te,ne,ae,re,ce,ue,fe,ve,he,ge,pe,ye,we,be,De,_e,Ce,Me,Te,Ee,Se,xe=x.opt,ke=x.trigger,He=x.renderOverlay,Re=x.clearOverlays,Fe=x.reportSelection,Ne=x.unselect,ze=x.daySelectionMousedown,Ae=x.slotSegHtml,Oe=x.cellToDate,$e=x.dateToCell,We=x.rangeToSegments,Le=a.formatDate,je={};W(n.addClass("fc-agenda")),ge=new le(function(t,n){function a(e){return Math.max(s,Math.min(c,e))}var r,o,i;F.each(function(t,a){r=e(a),o=r.offset().left,t&&(i[1]=o),i=[o],n[t]=i}),i[1]=o+r.outerWidth(),xe("allDaySlot")&&(o=(r=X).offset().top,t[0]=[o,o+r.outerHeight()]);for(var l=K.offset().top,s=J.offset().top,c=s+J.outerHeight(),d=0;he*ue>d;d++)t.push([a(l+fe*d),a(l+fe*(d+1))])}),pe=new se(ge),ye=new de(function(e){return O.eq(e)}),we=new de(function(e){return j.eq(e)})}function V(){function n(t){var n,o,i,l,s,c=A(),u=x(),v=S(),h=e.map(t,r),g=[];for(o=0;c>o;o++)for(d(n=z(0,o),u),s=X(s=a(t,h,n,d(f(n),v-u))),i=0;s.length>i;i++)(l=s[i]).col=o,g.push(l);return g}function a(e,t,n,a){var r,o,i,l,s,c,d,u,v=[],h=e.length;for(r=0;h>r;r++)i=(o=e[r]).start,(l=t[r])>n&&a>i&&(n>i?(s=f(n),d=!1):(s=i,d=!0),l>a?(c=f(a),u=!1):(c=l,u=!0),v.push({event:o,start:s,end:c,isStart:d,isEnd:u}));return v.sort(Q)}function r(e){return e.end?f(e.end):d(f(e.start),u("defaultEventMinutes"))}function o(n,a){var r,o,s,c,d,f,h,g,p,m,y,w,b,D,M,E,S=n.length,x="",R=C(),z=u("isRTL");for(r=0;S>r;r++)s=(o=n[r]).event,c=H(o.start,o.start),d=H(o.start,o.end),f=F(o.col),h=N(o.col),p=(g=(h-=.025*(g=h-f))-f)*(o.forwardCoord-o.backwardCoord),u("slotEventOverlap")&&(p=Math.max(2*(p-10),p)),z?m=(y=h-o.backwardCoord*g)-p:y=(m=f+o.backwardCoord*g)+p,m=Math.max(m,f),p=(y=Math.min(y,h))-m,o.top=c,o.left=m,o.outerWidth=p,o.outerHeight=d-c,x+=i(s,o);for(R[0].innerHTML=x,w=R.children(),r=0;S>r;r++)s=(o=n[r]).event,b=e(w[r]),!1===(D=v("eventRender",s,s,b))?b.remove():(D&&!0!==D&&(b.remove(),b=e(D).css({position:"absolute",top:o.top,left:o.left}).appendTo(R)),o.element=b,s._id===a?l(s,b,o):b[0]._fci=r,P(s,b));for(_(R,n,l),r=0;S>r;r++)(b=(o=n[r]).element)&&(o.vsides=k(b,!0),o.hsides=T(b,!0),(M=b.find(".fc-event-title")).length&&(o.contentTop=M[0].offsetTop));for(r=0;S>r;r++)(b=(o=n[r]).element)&&(b[0].style.width=Math.max(0,o.outerWidth-o.hsides)+"px",E=Math.max(0,o.outerHeight-o.vsides),b[0].style.height=E+"px",s=o.event,o.contentTop!==t&&10>E-o.contentTop&&(b.find("div.fc-event-time").text(G(s.start,u("timeFormat"))+" - "+s.title),b.find("div.fc-event-title").remove()),v("eventAfterRender",s,s,b))}function i(e,t){var n="<",a=e.url,r=j(e,u),o=["fc-event","fc-event-vert"];return g(e)&&o.push("fc-event-draggable"),t.isStart&&o.push("fc-event-start"),t.isEnd&&o.push("fc-event-end"),o=o.concat(e.className),e.source&&(o=o.concat(e.source.className||[])),n+=a?"a href='"+$(e.url)+"'":"div",n+=" class='"+o.join(" ")+"' style='position:absolute;top:"+t.top+"px;left:"+t.left+"px;"+r+"'><div class='fc-event-inner'><div class='fc-event-time'>"+$(ee(e.start,e.end,u("timeFormat")))+"</div><div class='fc-event-title'>"+$(e.title||"")+"</div></div><div class='fc-event-bg'></div>",t.isEnd&&p(e)&&(n+="<div class='ui-resizable-handle ui-resizable-s'>=</div>"),n+"</"+(a?"a":"div")+">"}function l(e,t,n){var a=t.find("div.fc-event-time");g(e)&&function(e,t,n){function a(){K(),i&&(g?(n.hide(),t.draggable("option","grid",null),J(s(f(e.start),w),s(D(e),w))):(function(t){var a,r=d(f(e.start),t);e.end&&(a=d(f(e.end),t)),n.text(ee(r,a,u("timeFormat")))}(b),n.css("display",""),t.draggable("option","grid",[T,E])))}var r,o,i,l,g,p,m,y,w,b,_,C=c.getCoordinateGrid(),M=A(),T=O(),E=W(),S=L();t.draggable({scroll:!1,grid:[T,E],axis:1==M&&"y",opacity:u("dragOpacity"),revertDuration:u("dragRevertDuration"),start:function(n,a){v("eventDragStart",t,e,n,a),q(e,t),C.build(),r=t.position(),o=C.cell(n.pageX,n.pageY),i=l=!0,g=p=R(o),m=y=0,w=0,b=_=0},drag:function(e,n){var s=C.cell(e.pageX,e.pageY);if(i=!!s){if(g=R(s),(m=Math.round((n.position.left-r.left)/T))!=y){var c=z(0,o.col),d=o.col+m;d=Math.max(0,d),d=Math.min(M-1,d);var u=z(0,d);w=h(u,c)}g||(b=Math.round((n.position.top-r.top)/E)*S)}(i!=l||g!=p||m!=y||b!=_)&&(a(),l=i,p=g,y=m,_=b),t.draggable("option","revert",!i)},stop:function(n,o){K(),v("eventDragStop",t,e,n,o),i&&(g||w||b)?B(this,e,w,g?0:b,g,n,o):(i=!0,g=!1,m=0,w=0,b=0,a(),t.css("filter",""),t.css(r),I(e,t))}})}(e,t,a),n.isEnd&&p(e)&&function(e,t,n){var a,r,o=W(),i=L();t.resizable({handles:{s:".ui-resizable-handle"},grid:o,start:function(n,o){a=r=0,q(e,t),v("eventResizeStart",this,e,n,o)},resize:function(l,s){(a=Math.round((Math.max(o,t.height())-s.originalSize.height)/o))!=r&&(n.text(ee(e.start,a||e.end?d(m(e),i*a):null,u("timeFormat"))),r=a)},stop:function(n,r){v("eventResizeStop",this,e,n,r),a?V(this,e,0,i*a,n,r):I(e,t)}})}(e,t,a),y(e,t)}var c=this;c.renderEvents=function(e,t){var a,r=e.length,i=[],l=[];for(a=0;r>a;a++)e[a].allDay?i.push(e[a]):l.push(e[a]);u("allDaySlot")&&(U(i,t),w()),o(n(l),t)},c.clearEvents=function(){b().empty(),C().empty()},c.slotSegHtml=i,te.call(c);var u=c.opt,v=c.trigger,g=c.isEventDraggable,p=c.isEventResizable,m=c.eventEnd,y=c.eventElementHandlers,w=c.setHeight,b=c.getDaySegmentContainer,C=c.getSlotSegmentContainer,E=c.getHoverListener,S=c.getMaxMinute,x=c.getMinMinute,H=c.timePosition,R=c.getIsCellAllDay,F=c.colContentLeft,N=c.colContentRight,z=c.cellToDate,A=c.getColCnt,O=c.getColWidth,W=c.getSnapHeight,L=c.getSnapMinutes,Y=c.getSlotContainer,P=c.reportEventElement,I=c.showEvents,q=c.hideEvents,B=c.eventDrop,V=c.eventResize,J=c.renderDayOverlay,K=c.clearOverlays,U=c.renderDayEvents,Z=c.calendar,G=Z.formatDate,ee=Z.formatDates;c.draggableDayEvent=function(e,t,n){function a(){c||(t.width(r).height("").draggable("option","grid",null),c=!0)}var r,o,i,l=n.isStart,c=!0,d=E(),g=O(),p=W(),m=L(),y=x();t.draggable({opacity:u("dragOpacity","month"),revertDuration:u("dragRevertDuration"),start:function(n,y){v("eventDragStart",t,e,n,y),q(e,t),r=t.width(),d.start(function(n,r){if(K(),n){o=!1;var d=z(0,r.col),v=z(0,n.col);i=h(v,d),n.row?l?c&&(t.width(g-10),M(t,p*Math.round((e.end?(e.end-e.start)/be:u("defaultEventMinutes"))/m)),t.draggable("option","grid",[g,1]),c=!1):o=!0:(J(s(f(e.start),i),s(D(e),i)),a()),o=o||c&&!i}else a(),o=!0;t.draggable("option","revert",o)},n,"drag")},stop:function(n,r){if(d.stop(),K(),v("eventDragStop",t,e,n,r),o)a(),t.css("filter",""),I(e,t);else{var l=0;c||(l=Math.round((t.offset().top-Y().offset().top)/p)*m+y-(60*e.start.getHours()+e.start.getMinutes())),B(this,e,i,l,c,n,r)}}})}}function X(e){var t,n=function(e){var t,n,a,r=[];for(t=0;e.length>t;t++){for(n=e[t],a=0;r.length>a&&U(n,r[a]).length;a++);(r[a]||(r[a]=[])).push(n)}return r}(e),a=n[0];if(function(e){var t,n,a,r,o;for(t=0;e.length>t;t++)for(n=e[t],a=0;n.length>a;a++)for((r=n[a]).forwardSegs=[],o=t+1;e.length>o;o++)U(r,e[o],r.forwardSegs)}(n),a){for(t=0;a.length>t;t++)J(a[t]);for(t=0;a.length>t;t++)K(a[t],0,0)}return function(e){var t,n,a,r=[];for(t=0;e.length>t;t++)for(n=e[t],a=0;n.length>a;a++)r.push(n[a]);return r}(n)}function J(e){var n,a,r=e.forwardSegs,o=0;if(e.forwardPressure===t){for(n=0;r.length>n;n++)J(a=r[n]),o=Math.max(o,1+a.forwardPressure);e.forwardPressure=o}}function K(e,n,a){var r,o=e.forwardSegs;if(e.forwardCoord===t)for(o.length?(o.sort(G),K(o[0],n+1,a),e.forwardCoord=o[0].backwardCoord):e.forwardCoord=1,e.backwardCoord=e.forwardCoord-(e.forwardCoord-a)/(n+1),r=0;o.length>r;r++)K(o[r],0,e.forwardCoord)}function U(e,t,n){n=n||[];for(var a=0;t.length>a;a++)Z(e,t[a])&&n.push(t[a]);return n}function Z(e,t){return e.end>t.start&&e.start<t.end}function G(e,t){return t.forwardPressure-e.forwardPressure||(e.backwardCoord||0)-(t.backwardCoord||0)||Q(e,t)}function Q(e,t){return e.start-t.start||t.end-t.start-(e.end-e.start)||(e.event.title||"").localeCompare(t.event.title)}function ee(n,a,r){function o(t,n){var a=x[t];return e.isPlainObject(a)?O(a,n||r):a}function i(e,t){return a.trigger.apply(a,[e,t||D].concat(Array.prototype.slice.call(arguments,2),[D]))}function l(e){return e.end?f(e.end):_(e)}function c(e,t,n){var a,r=E[e._id],o=r.length;for(a=0;o>a;a++)t&&r[a][0]==t[0]||r[a][n]()}function u(e,n,a,r){a=a||0;for(var o,i=e.length,l=0;i>l;l++)o=e[l],r!==t&&(o.allDay=r),d(s(o.start,n,!0),a),o.end&&(o.end=d(s(o.end,n,!0),a)),C(o,x)}function v(e,t,n){n=n||0;for(var a,r=e.length,o=0;r>o;o++)(a=e[o]).end=d(s(l(a),t,!0),n),C(a,x)}function g(e,t){var n=D.getColCnt(),a=z?-1:1,r=z?n-1:0;return"object"==typeof e&&(t=e.col,e=e.row),e*n+(t*a+r)}function p(e){var t=D.visStart.getDay();return e+=F[t],7*Math.floor(e/k)+N[(e%k+k)%k]-t}function m(e){var t=f(D.visStart);return s(t,e),t}function y(e){return h(e,D.visStart)}function w(e){var t=D.visStart.getDay();return e+=t,Math.floor(e/7)*k+F[(e%7+7)%7]-F[t]}function b(e){var t=D.getColCnt(),n=z?-1:1,a=z?t-1:0;return{row:Math.floor(e/t),col:(e%t+t)%t*n+a}}var D=this;D.element=n,D.calendar=a,D.name=r,D.opt=o,D.trigger=i,D.isEventDraggable=function(e){var t=e.source||{};return P(e.startEditable,t.startEditable,o("eventStartEditable"),e.editable,t.editable,o("editable"))&&!o("disableDragging")},D.isEventResizable=function(e){var t=e.source||{};return P(e.durationEditable,t.durationEditable,o("eventDurationEditable"),e.editable,t.editable,o("editable"))&&!o("disableResizing")},D.setEventData=function(e){T={};var t,n,a=e.length;for(t=0;a>t;t++)n=e[t],T[n._id]?T[n._id].push(n):T[n._id]=[n]},D.clearEventData=function(){T={},E={},S=[]},D.eventEnd=l,D.reportEventElement=function(e,t){S.push({event:e,element:t}),E[e._id]?E[e._id].push(t):E[e._id]=[t]},D.triggerEventDestroy=function(){e.each(S,function(e,t){D.trigger("eventDestroy",t.event,t.event,t.element)})},D.eventElementHandlers=function(e,n){n.click(function(a){return n.hasClass("ui-draggable-dragging")||n.hasClass("ui-resizable-resizing")?t:i("eventClick",this,e,a)}).hover(function(t){i("eventMouseover",this,e,t)},function(t){i("eventMouseout",this,e,t)})},D.showEvents=function(e,t){c(e,t,"show")},D.hideEvents=function(e,t){c(e,t,"hide")},D.eventDrop=function(e,t,n,a,r,o,l){var s=t.allDay,c=t._id;u(T[c],n,a,r),i("eventDrop",e,t,n,a,r,function(){u(T[c],-n,-a,s),M(c)},o,l),M(c)},D.eventResize=function(e,t,n,a,r,o){var l=t._id;v(T[l],n,a),i("eventResize",e,t,n,a,function(){v(T[l],-n,-a),M(l)},r,o),M(l)};var _=D.defaultEventEnd,C=a.normalizeEvent,M=a.reportEventChange,T={},E={},S=[],x=a.options;D.isHiddenDay=function(e){return"object"==typeof e&&(e=e.getDay()),R[e]},D.skipHiddenDays=function(e,t,n){for(t=t||1;R[(e.getDay()+(n?t:0)+7)%7];)s(e,t)},D.getCellsPerWeek=function(){return k},D.dateToCell=function(e){return b(w(y(e)))},D.dateToDayOffset=y,D.dayOffsetToCellOffset=w,D.cellOffsetToCell=b,D.cellToDate=function(){return m(p(g.apply(null,arguments)))},D.cellToCellOffset=g,D.cellOffsetToDayOffset=p,D.dayOffsetToDate=m,D.rangeToSegments=function(e,t){for(var n=D.getRowCnt(),a=D.getColCnt(),r=[],o=y(e),i=y(t),l=w(o),s=w(i)-1,c=0;n>c;c++){var d=c*a,u=d+a-1,f=Math.max(l,d),v=Math.min(s,u);if(v>=f){var h=b(f),g=b(v),m=[h.col,g.col].sort(),_=p(f)==o,C=p(v)+1==i;r.push({row:c,leftCol:m[0],rightCol:m[1],isStart:_,isEnd:C})}}return r};var k,H=o("hiddenDays")||[],R=[],F=[],N=[],z=o("isRTL");!function(){!1===o("weekends")&&H.push(0,6);for(var t=0,n=0;7>t;t++)F[t]=n,R[t]=-1!=e.inArray(t,H),R[t]||(N[n]=t,n++);if(!(k=n))throw"invalid hiddenDays"}()}function te(){function t(e,t,a){var r=n([e],!0,!1),o=[];return ae(r,function(e,n){e.row===t&&n.css("top",a),o.push(n[0])}),o}function n(t,n,r){var i,s,c=O(),d=n?e("<div/>"):c,u=a(t);return function(e){for(var t=v("isRTL"),n=0;e.length>n;n++){var a=e[n],r=(t?a.isEnd:a.isStart)?N:R,o=(t?a.isStart:a.isEnd)?A:F,i=r(a.leftCol),l=o(a.rightCol);a.left=i,a.outerWidth=l-i}}(u),i=o(u),d[0].innerHTML=i,s=d.children(),n&&c.append(s),function(t,n){for(var a=0;t.length>a;a++){var r=t[a],o=r.event,i=n.eq(a),l=g("eventRender",o,o,i);!1===l?i.remove():(l&&!0!==l&&(l=e(l).css({position:"absolute",left:r.left}),i.replaceWith(l),i=l),r.element=i)}}(u,s),ae(u,function(e,t){e.hsides=T(t,!0)}),ae(u,function(e,t){t.width(Math.max(0,e.outerWidth-e.hsides))}),ae(u,function(e,t){e.outerHeight=t.outerHeight(!0)}),l(u,r),u}function a(e){for(var t=[],n=0;e.length>n;n++){var a=r(e[n]);t.push.apply(t,a)}return t}function r(e){for(var t=e.start,n=D(e),a=B(t,n),r=0;a.length>r;r++)a[r].event=e;return a}function o(e){for(var t="",n=0;e.length>n;n++)t+=i(e[n]);return t}function i(e){var t="",n=v("isRTL"),a=e.event,r=a.url,o=["fc-event","fc-event-hori"];p(a)&&o.push("fc-event-draggable"),e.isStart&&o.push("fc-event-start"),e.isEnd&&o.push("fc-event-end"),o=o.concat(a.className),a.source&&(o=o.concat(a.source.className||[]));var i=j(a,v);return t+=r?"<a href='"+$(r)+"'":"<div",t+=" class='"+o.join(" ")+"' style='position:absolute;left:"+e.left+"px;"+i+"'><div class='fc-event-inner'>",!a.allDay&&e.isStart&&(t+="<span class='fc-event-time'>"+$(L(a.start,a.end,v("timeFormat")))+"</span>"),t+="<span class='fc-event-title'>"+$(a.title||"")+"</span></div>",e.isEnd&&m(a)&&(t+="<div class='ui-resizable-handle ui-resizable-"+(n?"w":"e")+"'>&nbsp;&nbsp;&nbsp;</div>"),t+"</"+(r?"a":"div")+">"}function l(e,t){var n=function(e){for(var t=x(),n=k(),a=[],r=function(e){var t,n,a,r=x(),o=[];for(t=0;e.length>t;t++)n=e[t],a=n.row,n.element&&(o[a]?o[a].push(n):o[a]=[n]);for(a=0;r>a;a++)o[a]=c(o[a]||[]);return o}(e),o=0;t>o;o++){for(var i=r[o],l=[],s=0;n>s;s++)l.push(0);for(var d=0;i.length>d;d++){var u=i[d];u.top=z(l.slice(u.leftCol,u.rightCol+1));for(var s=u.leftCol;u.rightCol>=s;s++)l[s]=u.top+u.outerHeight}a.push(z(l))}return a}(e),a=function(){var e,t=x(),n=[];for(e=0;t>e;e++)n[e]=H(e).find("div.fc-day-content > div");return n}(),r=[];if(t)for(var o=0;a.length>o;o++)a[o].height(n[o]);for(o=0;a.length>o;o++)r.push(a[o].position().top);ae(e,function(e,t){t.css("top",r[e.row]+e.top)})}function c(e){for(var t=[],n=function(e){e.sort(re);for(var t=[],n=0;e.length>n;n++){for(var a=e[n],r=0;t.length>r&&ne(a,t[r]);r++);t[r]?t[r].push(a):t[r]=[a]}return t}(e),a=0;n.length>a;a++)t.push.apply(t,n[a]);return t}function d(e,t,n){p(e)&&u.draggableDayEvent(e,t,n),n.isEnd&&m(e)&&u.resizableDayEvent(e,t,n),b(e,t)}var u=this;u.renderDayEvents=function(e,t){var a=n(e,!1,!0);ae(a,function(e,t){w(e.event,t)}),function(e,t){var n=O();ae(e,function(e,n,a){var r=e.event;r._id===t?d(r,n,e):n[0]._fci=a}),_(n,e,d)}(a,t),ae(a,function(e,t){g("eventAfterRender",e.event,e.event,t)})},u.draggableDayEvent=function(e,t){var n,a=q();t.draggable({delay:50,opacity:v("dragOpacity"),revertDuration:v("dragRevertDuration"),start:function(r,o){g("eventDragStart",t,e,r,o),M(e,t),a.start(function(a,r,o,i){if(t.draggable("option","revert",!a||!o&&!i),P(),a){var l=V(r),c=V(a);n=h(c,l),Y(s(f(e.start),n),s(D(e),n))}else n=0},r,"drag")},stop:function(r,o){a.stop(),P(),g("eventDragStop",t,e,r,o),n?E(this,e,n,0,e.allDay,r,o):(t.css("filter",""),C(e,t))}})},u.resizableDayEvent=function(n,a,r){var o=v("isRTL")?"w":"e",i=a.find(".ui-resizable-"+o),l=!1;W(a),a.mousedown(function(e){e.preventDefault()}).click(function(e){l&&(e.preventDefault(),e.stopImmediatePropagation())}),i.mousedown(function(i){if(1==i.which){l=!0;var c=q();x(),k();var d,u,f=a.css("top"),v=e.extend({},n),h=U(K(n.start));I(),e("body").css("cursor",o+"-resize").one("mouseup",function(t){g("eventResizeStop",this,n,t),e("body").css("cursor",""),c.stop(),P(),d&&S(this,n,d,0,t),setTimeout(function(){l=!1},0)}),g("eventResizeStart",this,n,i),c.start(function(a,i){if(a){var l=X(i),c=X(a);if(c=Math.max(c,h),d=J(c)-J(l)){v.end=s(y(n),d,!0);var g=u;u=t(v,r.row,f),(u=e(u)).find("*").css("cursor",o+"-resize"),g&&g.remove(),M(n)}else u&&(C(n),u.remove(),u=null);P(),Y(n.start,s(D(n),d))}},i)}})};var v=u.opt,g=u.trigger,p=u.isEventDraggable,m=u.isEventResizable,y=u.eventEnd,w=u.reportEventElement,b=u.eventElementHandlers,C=u.showEvents,M=u.hideEvents,E=u.eventDrop,S=u.eventResize,x=u.getRowCnt,k=u.getColCnt;u.getColWidth;var H=u.allDayRow,R=u.colLeft,F=u.colRight,N=u.colContentLeft,A=u.colContentRight;u.dateToCell;var O=u.getDaySegmentContainer,L=u.calendar.formatDates,Y=u.renderDayOverlay,P=u.clearOverlays,I=u.clearSelection,q=u.getHoverListener,B=u.rangeToSegments,V=u.cellToDate,X=u.cellToCellOffset,J=u.cellOffsetToDayOffset,K=u.dateToDayOffset,U=u.dayOffsetToCellOffset}function ne(e,t){for(var n=0;t.length>n;n++){var a=t[n];if(a.leftCol<=e.rightCol&&a.rightCol>=e.leftCol)return!0}return!1}function ae(e,t){for(var n=0;e.length>n;n++){var a=e[n],r=a.element;r&&t(a,r,n)}}function re(e,t){return t.rightCol-t.leftCol-(e.rightCol-e.leftCol)||t.event.allDay-e.event.allDay||e.event.start-t.event.start||(e.event.title||"").localeCompare(t.event.title)}function oe(){function t(e){c&&(c=!1,s(),o("unselect",null,e))}function n(e,t,n,a){c=!0,o("select",null,e,t,n,a)}var a=this;a.select=function(e,a,r){t(),a||(a=i(e,r)),l(e,a,r),n(e,a,r)},a.unselect=t,a.reportSelection=n,a.daySelectionMousedown=function(o){var i,c=a.cellToDate,d=a.getIsCellAllDay,u=a.getHoverListener(),f=a.reportDayClick;1==o.which&&r("selectable")&&(t(o),u.start(function(e,t){s(),e&&d(e)?(i=[c(t),c(e)].sort(N),l(i[0],i[1],!0)):i=null},o),e(document).one("mouseup",function(e){u.stop(),i&&(+i[0]==+i[1]&&f(i[0],!0,e),n(i[0],i[1],!0,e))}))};var r=a.opt,o=a.trigger,i=a.defaultSelectionEnd,l=a.renderSelection,s=a.clearSelection,c=!1;r("selectable")&&r("unselectAuto")&&e(document).mousedown(function(n){var a=r("unselectCancel");a&&e(n.target).parents(a).length||t(n)})}function ie(){this.renderOverlay=function(a,r){var o=n.shift();return o||(o=e("<div class='fc-cell-overlay' style='position:absolute;z-index:3'/>")),o[0].parentNode!=r[0]&&o.appendTo(r),t.push(o.css(a).show()),o},this.clearOverlays=function(){for(var e;e=t.shift();)n.push(e.hide().unbind())};var t=[],n=[]}function le(e){var t,n,a=this;a.build=function(){e(t=[],n=[])},a.cell=function(e,a){var r,o=t.length,i=n.length,l=-1,s=-1;for(r=0;o>r;r++)if(a>=t[r][0]&&t[r][1]>a){l=r;break}for(r=0;i>r;r++)if(e>=n[r][0]&&n[r][1]>e){s=r;break}return l>=0&&s>=0?{row:l,col:s}:null},a.rect=function(e,a,r,o,i){var l=i.offset();return{top:t[e][0]-l.top,left:n[a][0]-l.left,width:n[o][1]-n[a][0],height:t[r][1]-t[e][0]}}}function se(t){function n(e){ce(e);var n=t.cell(e.pageX,e.pageY);(!n!=!i||n&&(n.row!=i.row||n.col!=i.col))&&(n?(o||(o=n),r(n,o,n.row-o.row,n.col-o.col)):r(n,o),i=n)}var a,r,o,i;this.start=function(l,s,c){r=l,o=i=null,t.build(),n(s),a=c||"mousemove",e(document).bind(a,n)},this.stop=function(){return e(document).unbind(a,n),i}}function ce(e){e.pageX===t&&(e.pageX=e.originalEvent.pageX,e.pageY=e.originalEvent.pageY)}function de(e){function n(t){return r[t]=r[t]||e(t)}var a=this,r={},o={},i={};a.left=function(e){return o[e]=o[e]===t?n(e).position().left:o[e]},a.right=function(e){return i[e]=i[e]===t?a.left(e)+n(e).width():i[e]},a.clear=function(){r={},o={},i={}}}var ue={defaultView:"month",aspectRatio:1.35,header:{left:"title",center:"",right:"today prev,next"},weekends:!0,weekNumbers:!1,weekNumberCalculation:"iso",weekNumberTitle:"W",allDayDefault:!0,ignoreTimezone:!0,lazyFetching:!0,startParam:"start",endParam:"end",titleFormat:{month:"MMMM yyyy",week:"MMM d[ yyyy]{ '&#8212;'[ MMM] d yyyy}",day:"dddd, MMM d, yyyy"},columnFormat:{month:"ddd",week:"ddd M/d",day:"dddd M/d"},timeFormat:{"":"h(:mm)t"},isRTL:!1,firstDay:0,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],buttonText:{prev:"<span class='fc-text-arrow'>&lsaquo;</span>",next:"<span class='fc-text-arrow'>&rsaquo;</span>",prevYear:"<span class='fc-text-arrow'>&laquo;</span>",nextYear:"<span class='fc-text-arrow'>&raquo;</span>",today:"today",month:"month",week:"week",day:"day"},theme:!1,buttonIcons:{prev:"circle-triangle-w",next:"circle-triangle-e"},unselectAuto:!0,dropAccept:"*",handleWindowResize:!0},fe={header:{left:"next,prev today",center:"",right:"title"},buttonText:{prev:"<span class='fc-text-arrow'>&rsaquo;</span>",next:"<span class='fc-text-arrow'>&lsaquo;</span>",prevYear:"<span class='fc-text-arrow'>&raquo;</span>",nextYear:"<span class='fc-text-arrow'>&laquo;</span>"},buttonIcons:{prev:"circle-triangle-e",next:"circle-triangle-w"}},ve=e.fullCalendar={version:"1.6.4"},he=ve.views={};e.fn.fullCalendar=function(n){if("string"==typeof n){var r,o=Array.prototype.slice.call(arguments,1);return this.each(function(){var a=e.data(this,"fullCalendar");if(a&&e.isFunction(a[n])){var i=a[n].apply(a,o);r===t&&(r=i),"destroy"==n&&e.removeData(this,"fullCalendar")}}),r!==t?r:this}var i=(n=n||{}).eventSources||[];return delete n.eventSources,n.events&&(i.push(n.events),delete n.events),n=e.extend(!0,{},ue,n.isRTL||n.isRTL===t&&ue.isRTL?fe:{},n),this.each(function(t,r){var o=e(r),l=new a(o,n,i);o.data("fullCalendar",l),l.render()}),this},ve.sourceNormalizers=[],ve.sourceFetchers=[];var ge={dataType:"json",cache:!1},pe=1;ve.addDays=s,ve.cloneDate=f,ve.parseDate=p,ve.parseISO8601=m,ve.parseTime=y,ve.formatDate=w,ve.formatDates=b;var me=["sun","mon","tue","wed","thu","fri","sat"],ye=864e5,we=36e5,be=6e4,De={s:function(e){return e.getSeconds()},ss:function(e){return A(e.getSeconds())},m:function(e){return e.getMinutes()},mm:function(e){return A(e.getMinutes())},h:function(e){return e.getHours()%12||12},hh:function(e){return A(e.getHours()%12||12)},H:function(e){return e.getHours()},HH:function(e){return A(e.getHours())},d:function(e){return e.getDate()},dd:function(e){return A(e.getDate())},ddd:function(e,t){return t.dayNamesShort[e.getDay()]},dddd:function(e,t){return t.dayNames[e.getDay()]},M:function(e){return e.getMonth()+1},MM:function(e){return A(e.getMonth()+1)},MMM:function(e,t){return t.monthNamesShort[e.getMonth()]},MMMM:function(e,t){return t.monthNames[e.getMonth()]},yy:function(e){return(e.getFullYear()+"").substring(2)},yyyy:function(e){return e.getFullYear()},t:function(e){return 12>e.getHours()?"a":"p"},tt:function(e){return 12>e.getHours()?"am":"pm"},T:function(e){return 12>e.getHours()?"A":"P"},TT:function(e){return 12>e.getHours()?"AM":"PM"},u:function(e){return w(e,"yyyy-MM-dd'T'HH:mm:ss'Z'")},S:function(e){var t=e.getDate();return t>10&&20>t?"th":["st","nd","rd"][t%10-1]||"th"},w:function(e,t){return t.weekNumberCalculation(e)},W:function(e){return function(e){var t,n=new Date(e.getTime());return n.setDate(n.getDate()+4-(n.getDay()||7)),t=n.getTime(),n.setMonth(0),n.setDate(1),Math.floor(Math.round((t-n)/864e5)/7)+1}(e)}};ve.dateFormatters=De,ve.applyAll=Y,he.month=function(e,t){var n=this;n.render=function(e,t){t&&(l(e,t),e.setDate(1));var d=a("firstDay"),u=f(e,!0);u.setDate(1);var v=l(f(u),1),g=f(u);s(g,-(g.getDay()-d+7)%7),o(g);var p=f(v);s(p,(7-p.getDay()+d)%7),o(p,-1,!0);var m=i(),y=Math.round(h(p,g)/7);"fixed"==a("weekMode")&&(s(p,7*(6-y)),y=6),n.title=c(u,a("titleFormat")),n.start=u,n.end=v,n.visStart=g,n.visEnd=p,r(y,m,!0)},I.call(n,e,t,"month");var a=n.opt,r=n.renderBasic,o=n.skipHiddenDays,i=n.getCellsPerWeek,c=t.formatDate},he.basicWeek=function(e,t){var n=this;n.render=function(e,t){t&&s(e,7*t);var c=s(f(e),-(e.getDay()-a("firstDay")+7)%7),d=s(f(c),7),u=f(c);o(u);var v=f(d);o(v,-1,!0);var h=i();n.start=c,n.end=d,n.visStart=u,n.visEnd=v,n.title=l(u,s(f(v),-1),a("titleFormat")),r(1,h,!1)},I.call(n,e,t,"basicWeek");var a=n.opt,r=n.renderBasic,o=n.skipHiddenDays,i=n.getCellsPerWeek,l=t.formatDates},he.basicDay=function(e,t){var n=this;n.render=function(e,t){t&&s(e,t),o(e,0>t?-1:1);var l=f(e,!0),c=s(f(l),1);n.title=i(e,a("titleFormat")),n.start=n.visStart=l,n.end=n.visEnd=c,r(1,1,!1)},I.call(n,e,t,"basicDay");var a=n.opt,r=n.renderBasic,o=n.skipHiddenDays,i=t.formatDate},n({weekMode:"fixed"}),he.agendaWeek=function(e,t){var n=this;n.render=function(e,t){t&&s(e,7*t);var c=s(f(e),-(e.getDay()-a("firstDay")+7)%7),d=s(f(c),7),u=f(c);o(u);var v=f(d);o(v,-1,!0);var h=i();n.title=l(u,s(f(v),-1),a("titleFormat")),n.start=c,n.end=d,n.visStart=u,n.visEnd=v,r(h)},B.call(n,e,t,"agendaWeek");var a=n.opt,r=n.renderAgenda,o=n.skipHiddenDays,i=n.getCellsPerWeek,l=t.formatDates},he.agendaDay=function(e,t){var n=this;n.render=function(e,t){t&&s(e,t),o(e,0>t?-1:1);var l=f(e,!0),c=s(f(l),1);n.title=i(e,a("titleFormat")),n.start=n.visStart=l,n.end=n.visEnd=c,r(1)},B.call(n,e,t,"agendaDay");var a=n.opt,r=n.renderAgenda,o=n.skipHiddenDays,i=t.formatDate},n({allDaySlot:!0,allDayText:"all-day",firstHour:6,slotMinutes:30,defaultEventMinutes:120,axisFormat:"h(:mm)tt",timeFormat:{agenda:"h:mm{ - h:mm}"},dragOpacity:{agenda:.5},minTime:0,maxTime:24,slotEventOverlap:!0})}(jQuery),window.initDashboardCalendar=function(){calendarTool.initDashboardCalendar()};var fc_ready=!1;window.initCalendarTool=function(){responsiveCalendar();$(".melis-draggable-input").draggable({zIndex:999,revert:!0,revertDuration:0,start:function(){"undefined"!=typeof mainYScroller&&mainYScroller.disable()},stop:function(){"undefined"!=typeof mainYScroller&&mainYScroller.enable()}}),$(".melis-draggable-input").on("click",function(){$(this).focus()}),$("#calendar-tool").fullCalendar({header:{left:"prev,next today",center:"title"},buttonText:{today:translations.tr_melistoolcalendar_fullcalendar_today,month:"month",week:"week",day:"day"},monthNames:[translations.tr_melistoolcalendar_fullcalendar_jan,translations.tr_melistoolcalendar_fullcalendar_feb,translations.tr_melistoolcalendar_fullcalendar_mar,translations.tr_melistoolcalendar_fullcalendar_apr,translations.tr_melistoolcalendar_fullcalendar_may,translations.tr_melistoolcalendar_fullcalendar_jun,translations.tr_melistoolcalendar_fullcalendar_jul,translations.tr_melistoolcalendar_fullcalendar_aug,translations.tr_melistoolcalendar_fullcalendar_sep,translations.tr_melistoolcalendar_fullcalendar_oct,translations.tr_melistoolcalendar_fullcalendar_nov,translations.tr_melistoolcalendar_fullcalendar_dec],dayNamesShort:[translations.tr_melistoolcalendar_fullcalendar_sun,translations.tr_melistoolcalendar_fullcalendar_mon,translations.tr_melistoolcalendar_fullcalendar_tue,translations.tr_melistoolcalendar_fullcalendar_wed,translations.tr_melistoolcalendar_fullcalendar_thu,translations.tr_melistoolcalendar_fullcalendar_fri,translations.tr_melistoolcalendar_fullcalendar_sat],editable:!0,droppable:!0,titleFormat:{day:"YYYY-MM-DD"},events:"/melis/MelisCalendar/ToolCalendar/retrieveCalendarEvents",drop:function(e,t){var n=new Array;n.push({name:"cal_event_title",value:$("#newCalendarEventInt").val()}),n.push({name:"cal_date_start",value:$.fullCalendar.formatDate(e,"yyyy-MM-dd")}),n=$.param(n),$.ajax({type:"POST",url:"/melis/MelisCalendar/ToolCalendar/saveEvent",data:n,dataType:"json",encode:!0}).done(function(e){if(e.success){if(null!==e.event){var t=e.event,n={id:t.id,title:t.id+" : "+t.title,start:t.start,end:t.end},a=$.extend({},n);$("#calendar-tool").fullCalendar("renderEvent",a,!0),$("#newCalendarEventInt").val(""),melisHelper.zoneReload("id_melistoolcalendar_tool_recent_added","melistoolcalendar_tool_recent_added"),melisHelper.melisOkNotification(e.textTitle,e.textMessage),melisCore.flashMessenger()}}else melisCoreTool.alertDanger("#siteaddalert","",e.textMessage),melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors)}).fail(function(){alert(translations.tr_meliscore_error_message)})},eventRender:function(e,t){t.append("<span class='event-icon'><i class='fa fa-pencil-square-o update-event' data-id='"+e._id+"'></i><i class='fa fa-trash-o delete-event' data-id='"+e._id+"'></i></span>")},eventResize:function(e){calendarTool.reschedEvent(e)},eventDrop:function(e){calendarTool.reschedEvent(e)},eventAfterAllRender:function(e){calendarTool.gotoFCdate(),fc_ready=!0},loading:function(){fc_ready=!0}})};var fcal_year_client_event=null,fcal_month_client_event=null,calendarTool={getCalendarData:function(){initCalendarTool()},reschedEvent:function(e){e.id;var t=$.fullCalendar.formatDate(e.start,"yyyy-MM-dd"),n=$.fullCalendar.formatDate(e.end,"yyyy-MM-dd"),a=new Array;a.push({name:"cal_id",value:e.id}),a.push({name:"cal_date_start",value:t}),a.push({name:"cal_date_end",value:n}),a=$.param(a),$.ajax({type:"POST",url:"/melis/MelisCalendar/ToolCalendar/reschedEvent",data:a,dataType:"json",encode:!0}).done(function(e){e.success?(melisHelper.melisOkNotification(e.textTitle,e.textMessage),melisCore.flashMessenger()):(melisCoreTool.alertDanger("#siteaddalert","",e.textMessage),melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors))}).fail(function(){alert(translations.tr_meliscore_error_message)})},deleteEvent:function(e){melisCoreTool.confirm(translations.tr_melistoolcalendar_delete_event_btn_yes,translations.tr_melistoolcalendar_delete_event_btn_no,translations.tr_melistoolcalendar_delete_event_title,translations.tr_melistoolcalendar_delete_event_confirm,function(){$.ajax({type:"POST",url:"/melis/MelisCalendar/ToolCalendar/deleteEvent",data:{cal_id:e},dataType:"json",encode:!0}).done(function(t){t.success?($("#calendar-tool").fullCalendar("removeEvents",e),melisHelper.melisOkNotification(t.textTitle,t.textMessage),melisCore.flashMessenger(),melisHelper.zoneReload("id_melistoolcalendar_tool_recent_added","melistoolcalendar_tool_recent_added")):(melisCoreTool.alertDanger("#siteaddalert","",t.textMessage),melisHelper.melisKoNotification(t.textTitle,t.textMessage,t.errors))}).fail(function(){alert(translations.tr_meliscore_error_message)})})},editEventTitle:function(e){calVal_eventId=e,calVal_id="id_meliscalendar_tool_edit_event_modal",calVal_melisKey="meliscalendar_tool_edit_event_modal",modalUrl="/melis/MelisCalendar/Calendar/renderCalendarModal",melisHelper.createModal(calVal_id,calVal_melisKey,!1,{cal_id:e},modalUrl)},saveEventTitle:function(){var e=new Array;e.push({name:"cal_id",value:calVal_eventId});var t=$("body #"+calVal_id+" #newCalendarEventInt").val();e.push({name:"cal_event_title",value:t}),e=$.param(e),$.ajax({type:"POST",url:"/melis/MelisCalendar/ToolCalendar/saveEvent",data:e,dataType:"json",encode:!0}).done(function(e){if(e.success){var n=$("#calendar-tool").fullCalendar("clientEvents",calVal_eventId)[0],a=calVal_eventId+" : "+t;n.title=a,$("#calendar-tool").fullCalendar("updateEvent",n),$("#"+calVal_id+"_container").modal("hide"),melisHelper.melisOkNotification(e.textTitle,e.textMessage),melisCore.flashMessenger()}else melisCoreTool.alertDanger("#siteaddalert","",e.textMessage),melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors)}).fail(function(){alert(translations.tr_meliscore_error_message)})},gotoFCdate:function(){null!=fcal_year_client_event&&null!=fcal_month_client_event&&($("#calendar-tool").fullCalendar("gotoDate",fcal_year_client_event,fcal_month_client_event),fcal_year_client_event=null,fcal_month_client_event=null)},initDashboardCalendar:function(){var e=new Array;$.ajax({url:"/melis/MelisCalendar/ToolCalendar/retrieveDashboardCalendarEvents",dataType:"json",encode:!0}).done(function(t){$.each(t,function(){e.push(String(this.dates))}),$(".dashbaorad-calendar-tool").datepicker({format:"yyyy-mm-dd",inline:!0,showOtherMonths:!0,todayHighlight:!0,toggleActive:!0,beforeShowDay:function(t){var n=t,a=("0"+n.getDate()).slice(-2),r=("0"+(n.getMonth()+1)).slice(-2),o=n.getFullYear()+"-"+r+"-"+a;if(-1!=$.inArray(o,e))return{classes:"calendar-highlight calendar-event"}}}).on("changeDate",function(t){var n=t.format("yyyy-mm-dd");-1!=$.inArray(n,e)&&($("#id_meliscore_menu_toolstree li[data-tool-id='id_meliscalendar_tool']").trigger("click"),$("#id_meliscalendar_tool").length&&(fcal_year_client_event=parseInt(t.format("yyyy")),fcal_month_client_event=parseInt(t.format("m"))-1,fc_ready&&melisHelper.zoneReload("id_melistoolcalendar_tool_calendar_content","melistoolcalendar_tool_calendar_content")))})}).fail(function(){alert(translations.tr_meliscore_error_message)})}};$(function(){var e=$("body");initDashboardCalendar(),e.on("click",".delete-event",function(e){var t=$(this);calendarTool.deleteEvent(t.data("id"))}),e.on("click",".update-event",function(e){var t=$(this);calendarTool.editEventTitle(t.data("id"))}),e.on("click",".btnSaveEventTitle",function(e){var t=$(this);calendarTool.saveEventTitle(t.data("id"))}),e.on("keyup keypress","#idformcalendar",function(e){if(13===(e.keyCode||e.which))return e.preventDefault(),!1})}),$(window).on("resize",function(){responsiveCalendar()});
